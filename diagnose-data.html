<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>è¯Šæ–­æ•°æ®é—®é¢˜</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .diagnosis { margin: 20px 0; padding: 15px; border-radius: 8px; }
        .info { background: #e3f2fd; }
        .error { background: #ffebee; }
        .success { background: #e8f5e9; }
        button { background: #2196f3; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; margin: 5px; }
        pre { background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 6px; overflow: auto; }
    </style>
</head>
<body>
    <h1>ğŸ” FocusBoard æ•°æ®è¯Šæ–­å·¥å…·</h1>
    
    <div class="diagnosis info">
        <h3>æ­¥éª¤ 1: æ£€æŸ¥ localStorage</h3>
        <button onclick="checkStorage()">æ£€æŸ¥æ‰€æœ‰å­˜å‚¨çš„æ•°æ®</button>
        <pre id="storage-output"></pre>
    </div>
    
    <div class="diagnosis info">
        <h3>æ­¥éª¤ 2: æŸ¥çœ‹å½“å‰ç”¨æˆ·</h3>
        <button onclick="checkUser()">æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·</button>
        <pre id="user-output"></pre>
    </div>
    
    <div class="diagnosis info">
        <h3>æ­¥éª¤ 3: æ£€æŸ¥ thisWeek æ•°æ®</h3>
        <button onclick="checkThisWeek()">æ£€æŸ¥ thisWeek ä»»åŠ¡</button>
        <pre id="thisweek-output"></pre>
    </div>

    <script>
        function checkStorage() {
            const output = document.getElementById('storage-output');
            const keys = Object.keys(localStorage);
            
            let html = 'ğŸ“¦ localStorage ä¸­çš„æ‰€æœ‰æ•°æ®:\n\n';
            keys.forEach(key => {
                const value = localStorage.getItem(key);
                html += `${key}: ${value}\n`;
            });
            
            output.textContent = html;
        }
        
        function checkUser() {
            const output = document.getElementById('user-output');
            try {
                const auth = JSON.parse(localStorage.getItem('auth'));
                const userId = auth?.user?.sub;
                
                let html = `å½“å‰ç”¨æˆ·ä¿¡æ¯:\n`;
                html += `ç”¨æˆ· ID: ${userId || 'null'}\n`;
                html += `ç”¨æˆ·åç§°: ${auth?.user?.name || 'null'}\n`;
                html += `ç”¨æˆ·é‚®ç®±: ${auth?.user?.email || 'null'}\n`;
                
                if (userId) {
                    html += `\nç›¸å…³å­˜å‚¨ key:\n`;
                    html += `- todos_${userId}\n`;
                    html += `- calendar_${userId}\n`;
                }
                
                output.textContent = html;
            } catch(e) {
                output.textContent = 'é”™è¯¯: ' + e.message;
            }
        }
        
        function checkThisWeek() {
            const output = document.getElementById('thisweek-output');
            try {
                const auth = JSON.parse(localStorage.getItem('auth'));
                const userId = auth?.user?.sub;
                
                if (!userId) {
                    output.textContent = 'âŒ æ²¡æœ‰ç™»å½•ç”¨æˆ·';
                    return;
                }
                
                const todosKey = `todos_${userId}`;
                const todos = JSON.parse(localStorage.getItem(todosKey) || 'null');
                
                let html = `ç”¨æˆ· ID: ${userId}\n`;
                html += `å­˜å‚¨ key: ${todosKey}\n`;
                html += `\ntodos æ•°æ®:\n${JSON.stringify(todos, null, 2)}\n`;
                
                if (todos && todos.thisWeek) {
                    html += `\nâœ… thisWeek ä»»åŠ¡æ•°é‡: ${todos.thisWeek.length}\n`;
                    html += `ä»»åŠ¡åˆ—è¡¨: ${JSON.stringify(todos.thisWeek, null, 2)}`;
                } else {
                    html += `\nâŒ æ²¡æœ‰æ‰¾åˆ° thisWeek æ•°æ®`;
                }
                
                output.textContent = html;
            } catch(e) {
                output.textContent = 'é”™è¯¯: ' + e.message;
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥
        window.onload = function() {
            checkUser();
            checkThisWeek();
        };
    </script>
</body>
</html>

